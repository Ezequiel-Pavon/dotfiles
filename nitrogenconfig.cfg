(defun nitro-write-config (&optional last-file)
  "Escribe configs básicas de Nitrogen. Si LAST-FILE está, lo guarda como fondo actual."
  (interactive)
  (let* ((confdir (expand-file-name "~/.config/nitrogen"))
         (cfg     (expand-file-name "nitrogen.cfg" confdir))
         (bg      (expand-file-name "bg-saved.cfg" confdir)))
    (make-directory confdir t)
    ;; nitrogen.cfg básico
    (with-temp-file cfg
      (insert "[geometry]\n"
              "posx=0\nposy=0\nsizex=800\nsizey=600\n\n"
              "[nitrogen]\n"
              "view=icon\nrecurse=true\nsort=alpha\n"
              "dirs=" (expand-file-name nitro-wallpaper-dir) "\n"))
    ;; bg-saved.cfg si hay último fondo
    (when (and last-file (file-exists-p last-file))
      (with-temp-file bg
        (insert "[xin_-1]\n"
                "file=" (expand-file-name last-file) "\n"
                "mode=" (substring nitro-set-mode 5) "\n" ; quita "--set-"
                "bgcolor=#000000\n")))
    (message "Nitrogen config escrita en %s (y %s%s)"
             cfg bg (if (and last-file (file-exists-p last-file)) " actualizado" " no tocado"))))

;; Ejemplos de uso:
;; (nitro-write-config)                ; escribe nitrogen.cfg
;; (nitro-write-config "/ruta/a/tu.jpg"); también setea bg-saved.cfg a ese archivo
